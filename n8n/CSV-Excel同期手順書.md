# CSV-Excel同期操作手順書

## 🔄 同期の種類

### **1. CSV → Excel 同期（新データ追加）**

n8nでCSVに追加されたデータをExcelに反映する際に使用：

```bash
python3 scripts/sync_csv_excel.py --csv-to-excel
```

**実行タイミング**:
- n8nで新しいメールが処理された後
- ラベル付け作業を開始する前

**処理内容**:
- CSVの新しいレコードをExcelに追加
- 既存のラベル付きデータを保持
- ドロップダウン機能を再設定

### **2. Excel → CSV 同期（ラベル反映）**

Excelでラベル付けした結果をCSVに反映する際に使用：

```bash
python3 scripts/sync_csv_excel.py --excel-to-csv
```

**実行タイミング**:
- ラベル付け作業完了後
- モデル更新を実行する前

**処理内容**:
- Excelの正解ラベルをCSVに転写
- モデル学習用データを準備

---

## 🚀 推奨運用フロー

### **日次運用**
1. n8nがCSVに自動書き込み
2. 手動で CSV → Excel 同期実行
3. Excelでラベル付け作業
4. Excel → CSV 同期実行

### **週次運用**
1. モデル更新実行
2. API反映
3. 精度確認

---

## ⚠️ 注意事項

- 同期前に必ずバックアップが作成されます
- Excelファイルでの作業中は同期を実行しないでください
- エラーが発生した場合はバックアップから復元可能です

---

*作成日: 2025-07-24*
